FROM golang:1.17.5-alpine AS build

WORKDIR /src/
COPY . /src/

RUN apk update && apk add git
RUN go mod download
RUN CGO_ENABLED=0 go build -o /bin/vulnerability-exporter

FROM scratch
COPY --from=build /bin/vulnerability-exporter /bin/vulnerability-exporter
ENTRYPOINT ["/bin/vulnerability-exporter"]